#!/bin/bash

export $(bin/supabase status --output env 2>/dev/null | grep ANON_KEY | tr -d '"')

if [ -z "$ANON_KEY" ]; then
	echo "ANON_KEY is not set"
	exit 1
fi

bin/psql -c """
delete from vault.secrets;
select vault.create_secret('http://host.docker.internal:54321', 'app_url');
select vault.create_secret('${ANON_KEY}', 'supabase_anon_key');
"""
