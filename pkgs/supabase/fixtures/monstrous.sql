set search_path to pgflow;

delete from pgflow.step_states where flow_slug = 'monstrous';
delete from pgflow.runs where flow_slug = 'monstrous';
delete from pgflow.deps where flow_slug = 'monstrous';
delete from pgflow.steps where flow_slug = 'monstrous';
delete from pgflow.flows where flow_slug = 'monstrous';

insert into pgflow.flows (flow_slug) values ('monstrous');

-- Create 200+ nodes across 26 parallel branches (a-z)
insert into pgflow.steps (flow_slug, step_slug) values
('monstrous', 'r'), -- root node
('monstrous', 'z'), -- final node
-- Branch a (8 nodes)
('monstrous', 'a1'),
('monstrous', 'a2'),
('monstrous', 'a3'),
('monstrous', 'a4'),
('monstrous', 'a5'),
('monstrous', 'a6'),
('monstrous', 'a7'),
('monstrous', 'a8'),
-- Branch b (8 nodes)
('monstrous', 'b1'),
('monstrous', 'b2'),
('monstrous', 'b3'),
('monstrous', 'b4'),
('monstrous', 'b5'),
('monstrous', 'b6'),
('monstrous', 'b7'),
('monstrous', 'b8'),
-- Branch c through x follow same pattern
('monstrous', 'c1'),
('monstrous', 'c2'),
('monstrous', 'c3'),
('monstrous', 'c4'),
('monstrous', 'c5'),
('monstrous', 'c6'),
('monstrous', 'c7'),
('monstrous', 'c8'),
('monstrous', 'd1'),
('monstrous', 'd2'),
('monstrous', 'd3'),
('monstrous', 'd4'),
('monstrous', 'd5'),
('monstrous', 'd6'),
('monstrous', 'd7'),
('monstrous', 'd8'),
('monstrous', 'e1'),
('monstrous', 'e2'),
('monstrous', 'e3'),
('monstrous', 'e4'),
('monstrous', 'e5'),
('monstrous', 'e6'),
('monstrous', 'e7'),
('monstrous', 'e8'),
('monstrous', 'f1'),
('monstrous', 'f2'),
('monstrous', 'f3'),
('monstrous', 'f4'),
('monstrous', 'f5'),
('monstrous', 'f6'),
('monstrous', 'f7'),
('monstrous', 'f8'),
('monstrous', 'g1'),
('monstrous', 'g2'),
('monstrous', 'g3'),
('monstrous', 'g4'),
('monstrous', 'g5'),
('monstrous', 'g6'),
('monstrous', 'g7'),
('monstrous', 'g8'),
('monstrous', 'h1'),
('monstrous', 'h2'),
('monstrous', 'h3'),
('monstrous', 'h4'),
('monstrous', 'h5'),
('monstrous', 'h6'),
('monstrous', 'h7'),
('monstrous', 'h8'),
('monstrous', 'i1'),
('monstrous', 'i2'),
('monstrous', 'i3'),
('monstrous', 'i4'),
('monstrous', 'i5'),
('monstrous', 'i6'),
('monstrous', 'i7'),
('monstrous', 'i8'),
('monstrous', 'j1'),
('monstrous', 'j2'),
('monstrous', 'j3'),
('monstrous', 'j4'),
('monstrous', 'j5'),
('monstrous', 'j6'),
('monstrous', 'j7'),
('monstrous', 'j8'),
('monstrous', 'k1'),
('monstrous', 'k2'),
('monstrous', 'k3'),
('monstrous', 'k4'),
('monstrous', 'k5'),
('monstrous', 'k6'),
('monstrous', 'k7'),
('monstrous', 'k8'),
('monstrous', 'l1'),
('monstrous', 'l2'),
('monstrous', 'l3'),
('monstrous', 'l4'),
('monstrous', 'l5'),
('monstrous', 'l6'),
('monstrous', 'l7'),
('monstrous', 'l8'),
('monstrous', 'm1'),
('monstrous', 'm2'),
('monstrous', 'm3'),
('monstrous', 'm4'),
('monstrous', 'm5'),
('monstrous', 'm6'),
('monstrous', 'm7'),
('monstrous', 'm8'),
('monstrous', 'n1'),
('monstrous', 'n2'),
('monstrous', 'n3'),
('monstrous', 'n4'),
('monstrous', 'n5'),
('monstrous', 'n6'),
('monstrous', 'n7'),
('monstrous', 'n8'),
('monstrous', 'o1'),
('monstrous', 'o2'),
('monstrous', 'o3'),
('monstrous', 'o4'),
('monstrous', 'o5'),
('monstrous', 'o6'),
('monstrous', 'o7'),
('monstrous', 'o8'),
('monstrous', 'p1'),
('monstrous', 'p2'),
('monstrous', 'p3'),
('monstrous', 'p4'),
('monstrous', 'p5'),
('monstrous', 'p6'),
('monstrous', 'p7'),
('monstrous', 'p8'),
('monstrous', 'q1'),
('monstrous', 'q2'),
('monstrous', 'q3'),
('monstrous', 'q4'),
('monstrous', 'q5'),
('monstrous', 'q6'),
('monstrous', 'q7'),
('monstrous', 'q8'),
('monstrous', 's1'),
('monstrous', 's2'),
('monstrous', 's3'),
('monstrous', 's4'),
('monstrous', 's5'),
('monstrous', 's6'),
('monstrous', 's7'),
('monstrous', 's8'),
('monstrous', 't1'),
('monstrous', 't2'),
('monstrous', 't3'),
('monstrous', 't4'),
('monstrous', 't5'),
('monstrous', 't6'),
('monstrous', 't7'),
('monstrous', 't8'),
('monstrous', 'u1'),
('monstrous', 'u2'),
('monstrous', 'u3'),
('monstrous', 'u4'),
('monstrous', 'u5'),
('monstrous', 'u6'),
('monstrous', 'u7'),
('monstrous', 'u8'),
('monstrous', 'v1'),
('monstrous', 'v2'),
('monstrous', 'v3'),
('monstrous', 'v4'),
('monstrous', 'v5'),
('monstrous', 'v6'),
('monstrous', 'v7'),
('monstrous', 'v8'),
('monstrous', 'w1'),
('monstrous', 'w2'),
('monstrous', 'w3'),
('monstrous', 'w4'),
('monstrous', 'w5'),
('monstrous', 'w6'),
('monstrous', 'w7'),
('monstrous', 'w8'),
('monstrous', 'x1'),
('monstrous', 'x2'),
('monstrous', 'x3'),
('monstrous', 'x4'),
('monstrous', 'x5'),
('monstrous', 'x6'),
('monstrous', 'x7'),
('monstrous', 'x8'),
('monstrous', 'y1'),
('monstrous', 'y2'),
('monstrous', 'y3'),
('monstrous', 'y4'),
('monstrous', 'y5'),
('monstrous', 'y6'),
('monstrous', 'y7'),
('monstrous', 'y8');

-- Create dependencies
insert into pgflow.deps (flow_slug, from_step_slug, to_step_slug)
select
    'monstrous',
    'r',
    letter || '1'
from
    unnest(array['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 's', 't', 'u', 'v', 'w', 'x', 'y']) as letter;

-- Chain dependencies within each branch
insert into pgflow.deps (flow_slug, from_step_slug, to_step_slug)
select
    'monstrous',
    letter || num::text,
    letter || (num + 1)::text
from
    unnest(array['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 's', 't', 'u', 'v', 'w', 'x', 'y']) as letter,
    generate_series(1, 7) as num;

-- Connect all final nodes to z
insert into pgflow.deps (flow_slug, from_step_slug, to_step_slug)
select
    'monstrous',
    letter || '8',
    'z'
from
    unnest(array['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 's', 't', 'u', 'v', 'w', 'x', 'y']) as letter;
