---
title: Install pgflow
description: Quick setup guide for pgflow on Supabase. Set up the workflow engine in your project with a simple npx command.
sidebar:
  order: 1
---

import { Aside, Steps } from "@astrojs/starlight/components";
import { FileTree } from '@astrojs/starlight/components';
import NotProductionReady from '@/components/NotProductionReady.astro';

Let's set up pgflow in your Supabase project. This setup needs to be done only once per project.

<NotProductionReady />

<Aside type="caution" title="Prerequisites">
- Supabase CLI version **2.0.2** or higher (check with `supabase -v`)
- A local Supabase project set up
- Deno installed (required for flow compilation)

If you haven't installed the CLI yet or need to upgrade, see Supabase's [installation guide](https://supabase.com/docs/guides/cli).
</Aside>

<Steps>

1. ### Run the installer

    pgflow includes a convenient installer that sets up everything you need. Run it with npx:

    ```bash frame="none"
    npx pgflow@latest install
    ```

    The installer will:
    - Detect your Supabase project automatically
    - Update your `config.toml` to enable connection pooling
    - Copy the required migrations to your migrations folder
    - Create a functions environment file if needed

    <Aside>
    If your Supabase directory isn't detected automatically, specify it manually:
    
    ```bash frame="none"
    npx pgflow@latest install --supabase-path=./path/to/supabase
    ```
    </Aside>

2. ### Apply configuration changes

    Restart your Supabase instance to apply the configuration changes:

    ```bash frame="none"
    npx supabase stop
    npx supabase start
    ```

3. ### Apply migrations

    If you haven't already, apply the migrations to create the pgflow schema and tables:

    ```bash frame="none"
    npx supabase db push
    ```

    This will create the following database objects:
    - `pgflow` schema with tables for workflows and execution state
    - SQL functions for workflow operations
    - Required extensions if not already present

4. ### Verify installation

    Let's make sure everything was installed correctly by checking if the `pgflow` schema exists.
    
    You can verify this using the **Supabase Studio**:
    
    1. Open Supabase Studio in your browser (typically at http://localhost:54323)
    2. Navigate to the **SQL Editor**
    3. Run the following query:
    
    ```sql
    SELECT schema_name FROM information_schema.schemata WHERE schema_name = 'pgflow';
    ```
    
    You should see:
    ```
    schema_name
    ------------
    pgflow
    ```

</Steps>

### What was installed?

The installer set up:

1. **Database schema** - Tables for workflow definitions and runtime state
2. **SQL functions** - Core functions to create, start, and manage workflows
3. **Connection pooling** - Required for Edge Worker operation
4. **Environment variables** - Database connection for Edge Functions

Your Supabase project now has everything needed to create and run workflows with pgflow!

## Example Workflow

After installation, you'll be able to create workflows like the website analyzer from our demo app:

```typescript
import { Flow } from '@pgflow/dsl';
import scrapeWebsite from '../_tasks/scrapeWebsite.ts';
import summarizeWithAI from '../_tasks/summarizeWithAI.ts';
import extractTags from '../_tasks/extractTags.ts';
import saveWebsite from '../_tasks/saveWebsite.ts';

type Input = {
  url: string;
  user_id: string;
};

export default new Flow<Input>({
  slug: 'analyze_website',
  maxAttempts: 3,
  timeout: 4,
  baseDelay: 1,
})
  .step(
    { slug: 'website' },
    async (input) => await scrapeWebsite(input.run.url),
  )
  .step(
    { slug: 'summary', dependsOn: ['website'] },
    async (input) => await summarizeWithAI(input.website.content),
  )
  .step({ slug: 'tags', dependsOn: ['website'] }, async (input) => {
    const { keywords } = await extractTags(input.website.content);
    return keywords;
  })
  .step({ slug: 'saveToDb', dependsOn: ['summary', 'tags'] }, async (input) => {
    const websiteData = {
      user_id: input.run.user_id,
      website_url: input.run.url,
      summary: input.summary,
      tags: input.tags,
    };
    const { website } = await saveWebsite(websiteData);

    return website;
  });
```

This workflow:
1. Fetches a website's content
2. Processes it in parallel to extract a summary and tags using AI
3. Saves the combined results to the database

### Next steps

Now that pgflow is installed, let's [create your first workflow](/pgflow/getting-started/create-first-flow/).