---
title: Run your Flow
description: Learn how to start a pgflow worker, trigger your flow, and monitor execution progress
sidebar:
  order: 40
next:
  link: /build/
  label: Develop flows
---

import { Aside, Steps, Tabs, CardGrid, LinkCard, FileTree } from "@astrojs/starlight/components";

This guide explains how to create Edge Workers to run your flows. If you just want to run the scaffolded example, see the [Quickstart](/get-started/flows/quickstart/).

<Aside type="tip" title="Already have a worker?">
If you used `pgflow install`, the `greet-user-worker` is already scaffolded. You can skip to step 3 to start it.
</Aside>

<Aside type="caution" title="Prerequisites">
Before starting, make sure you have:
- Compiled your flow: `npx pgflow@latest compile <flowSlug>`
- Applied migrations: `npx supabase migrations up`
</Aside>

<Steps>

1. ### Create a worker function

   For each flow, create an Edge Function to process its tasks:

   ```bash frame="none"
   npx supabase functions new my-flow-worker
   ```

   Replace contents of `index.ts` file with the following:

   ```typescript title="supabase/functions/my-flow-worker/index.ts"
   import { EdgeWorker } from "@pgflow/edge-worker";
   import { MyFlow } from '../../flows/my-flow.ts';

   EdgeWorker.start(MyFlow);
   ```

   <Aside title="The Edge Worker will:">
   1. Poll for tasks on the flow's queue
   2. Process tasks based on the step slug
   3. Return the appropriate result for each step
   4. Handle retries if any step fails
   </Aside>

2. ### Disable JWT verification

   Edit `supabase/config.toml` to disable JWT verification for local development:

   ```diff lang="toml"
     [functions.my-flow-worker]
     enabled = true
   - verify_jwt = true
   + verify_jwt = false
     import_map = "./functions/my-flow-worker/deno.json"
   ```

3. ### Start the Edge Runtime

   Start the Edge Runtime to make your worker function available:

   ```bash frame="none"
   npx supabase functions serve
   ```

   This will start the Edge Runtime server but not yet start your worker.
   You should see similar output in your terminal:

   ```
   Setting up Edge Functions runtime...
   Serving functions on http://127.0.0.1:54321/functions/v1/<function-name>
   Using supabase-edge-runtime-1.67.4 (compatible with Deno v2.1.4)
   serving the request with supabase/functions/greet-user-worker
   ```

   <Aside type="tip" title="Zero-config local development">
   When running locally with `supabase start`, the database connection is auto-detected using known Supabase local dev keys. No environment variables needed!

   For production deployment, see [Database Connection](/deploy/database-connection/).
   </Aside>

4. ### Start your worker

   In a new terminal, send an HTTP request to start your worker:

   ```bash frame="none"
   curl http://localhost:54321/functions/v1/my-flow-worker
   ```

   You should see output in your Edge Runtime terminal indicating the worker has started:

   ```
   [Info] [INFO] worker_id=unknown module=DenoAdapter DenoAdapter logger instance created and working.

   [Info] [INFO] worker_id=unknown module=DenoAdapter HTTP Request: null
   ```

   <Aside type="caution">
   If you have troubles starting the worker, make sure you disabled JWT verification in the previous step.
   </Aside>

   :::tip[Seamless local development]
   Tired of curling after every code change? Add the [watchdog cron](/deploy/supabase/keep-workers-running/) to your `supabase/seed.sql` (use `'2 seconds'` interval for fast local iteration) - it auto-restarts workers when they stop polling.
   :::

5. ### Trigger your first flow

   Now let's start a flow run! Using Supabase Studio:

   1. Open Supabase Studio in your browser (typically at http://localhost:54323)
   2. Navigate to the **SQL Editor**
   3. Execute this SQL to start your flow:

   ```sql
   SELECT * FROM pgflow.start_flow(
     flow_slug => 'greetUser',
     input => '{"firstName": "Alice", "lastName": "Smith"}'::jsonb
   );
   ```

   The output should look like:

   ```
   run_id        | flow_slug    | status  | input                                       | output | remaining_steps
   --------------+--------------+---------+---------------------------------------------+--------+-----------------
   <run_id UUID> | greetUser    | started | {"firstName": "Alice", "lastName": "Smith"} | null   | 2
   ```

6. ### Monitor execution

   Your worker should start processing tasks immediately. You should see log output in the Edge Runtime terminal as each step executes:

   ```
   [Info] [INFO] worker_id=<long UUID> module=ExecutionController Scheduling execution of task 1

   [Info] [INFO] worker_id=<long UUID> module=ExecutionController Scheduling execution of task 2
   ```

   You can check the run status using Supabase Studio:

   In the SQL Editor, run this query:

   ```sql
   SELECT * FROM pgflow.runs
   WHERE flow_slug = 'greetUser'
   ORDER BY started_at DESC
   LIMIT 1;
   ```

   As steps complete, you'll see the `remaining_steps` count decrease. When it reaches 0, the run will be marked as `completed`:

   ```
   run_id        | flow_slug    | status    | input                                       | output                              | remaining_steps
   --------------+--------------+-----------+---------------------------------------------+-------------------------------------+-----------------
   <run_id UUID> | greetUser    | completed | {"firstName": "Alice", "lastName": "Smith"} | {"greeting": "Hello, Alice Smith!"} | 0
   ```

</Steps>

## Where next?

<CardGrid>
  <LinkCard
    title="How pgflow works"
    href="/concepts/how-pgflow-works/"
    description="Understand how pgflow executes flows behind the scenes"
  />
  <LinkCard
    title="Ship to Supabase"
    href="/deploy/supabase/deploy-first-flow/"
    description="Deploy your flows to production on Supabase's hosted platform"
  />
  <LinkCard
    title="Make flows resilient"
    href="/reference/configuration/step-execution/"
    description="Configure retry behavior, timeouts, and error handling for your flows"
  />
  <LinkCard
    title="Observe runs with SQL"
    href="/deploy/monitor-execution/"
    description="Learn how to monitor and debug your flow execution with SQL queries"
  />
</CardGrid>
