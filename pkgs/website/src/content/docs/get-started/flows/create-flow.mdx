---
title: Create your first flow
description: Learn how to define a flow using pgflow's TypeScript DSL
sidebar:
  order: 20
---

import { Aside, Steps, Tabs, TabItem, CardGrid, LinkCard } from "@astrojs/starlight/components";
import { FileTree } from '@astrojs/starlight/components';

Now that pgflow is installed, let's create a simple hello world flow that demonstrates the core concepts.

Our flow will:

1. Take a person's **first name** and **last name** as input
2. Format a **full name**
3. Create a personalized **greeting**

<Aside type="caution" title="Prerequisites">
- Completed the [pgflow installation](/get-started/installation/)
- Basic understanding of TypeScript
</Aside>

## Creating a Simple Greeting Flow

<Steps>


1. ### Set up your project structure

   After running `pgflow install`, you already have a `flows/` directory with an example. Let's create a new flow:

   <FileTree>
   - supabase
     - flows
       - greet-user.ts (your flow definition)
       - index.ts (re-exports all flows)
     - functions
       - pgflow
         - index.ts (Control Plane)
         - deno.json
   </FileTree>

2. ### Create the flow definition

   Create a file called `supabase/flows/greet-user.ts` with this content:

   ```typescript title="supabase/flows/greet-user.ts"
   import { Flow } from '@pgflow/dsl';

   type Input = {
     firstName: string;
     lastName: string;
   };

   export const GreetUser = new Flow<Input>({
     slug: 'greetUser',
   })
     .step(
       { slug: 'fullName' },
       (input) => `${input.run.firstName} ${input.run.lastName}`
     )
     .step(
       { slug: 'greeting', dependsOn: ['fullName'] },
       (input) => `Hello, ${input.fullName}!`
     );
   ```

3. ### Register the flow

   Add your flow to `supabase/flows/index.ts`:

   ```diff lang="typescript" title="supabase/flows/index.ts"
    // Re-export all flows from this directory
    // Example: export { MyFlow } from './my-flow.ts';

    export { ExampleFlow } from './example-flow.ts';
   +export { GreetUser } from './greet-user.ts';
   ```

   That's it! The Control Plane in `supabase/functions/pgflow/index.ts` automatically imports all flows from your `flows/` directory using namespace imports:

   ```typescript title="supabase/functions/pgflow/index.ts"
   import { ControlPlane } from '@pgflow/edge-worker';
   import * as flows from '../../flows/index.ts';

   ControlPlane.serve(flows);
   ```

</Steps>

:::note[Key Concepts]
- **input.run**: Contains the original flow input, accessible in every step
- **step slugs**: Unique identifiers for each step
- **dependsOn**: Specifies which steps must complete before a step can run
- **JSON serialization**: All inputs and outputs must be JSON-serializable

<CardGrid>
  <LinkCard
    title="How pgflow works"
    href="/concepts/how-pgflow-works/"
    description="Learn how pgflow executes workflows behind the scenes"
  />
  <LinkCard
    title="Understanding flows"
    href="/concepts/understanding-flows/"
    description="Learn how flows work, from syntax to execution"
  />
</CardGrid>
:::
