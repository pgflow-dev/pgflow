---
title: How It Works
description: Discover how Edge Worker enhances Supabase Background Tasks with retries, concurrency control, and automatic scaling while ensuring zero message loss.
banner:
  content: |
    This guide is for <a href="/get-started/faq/#what-are-the-two-edge-worker-modes">Background Jobs Mode</a>. Main docs are <a href="/get-started/">here</a>
---

import { Aside } from "@astrojs/starlight/components";

**Edge Worker** is a task queue worker that gets messages from a queue and calls user functions with their payload.

```d2
...@../../../../assets/pgflow-theme.d2

direction: down

edge: Supabase Edge Functions {
  ew: Edge Worker
  ew.class: info
}

db: Database {
  pgmq: PGMQ Queue
  pgmq.class: success
  hb: Workers Table
  hb.class: success
}

prod: Your Application
prod.class: warning
handler: Task Handler
handler.class: warning

prod -> db.pgmq: sends message
db.pgmq -> edge.ew: reads messages
edge.ew -> db.pgmq: archives messages
edge.ew -> handler: processes messages
edge.ew -> db.hb: sends heartbeats
```

### Features

Under the hood, it wraps [Supabase Background Tasks](https://supabase.com/docs/guides/functions/background-tasks) and adds a lot of useful features:

- retries with delays
- concurrency control
- observability (heartbeats, logging)
- horizontal scaling (by deploying multiple edge functions for the same queue)

### CPU/clock limits

Edge Worker treats Edge Function termination due to CPU/clock limits
as an expected occurrence and includes extra measures to handle it as part of
normal operations:

- stops polling as soon as the soft limit is reached
- makes extra effort to gracefully abort pending tasks with abort signals
- uses PGMQ's visibility timeout to ensure **no message is ever lost**
- **spawns new instances** automatically for **continuous operations**
- pings the database with **heartbeats** to ensure the worker's health
