---
title: Organize Flow code
description: Learn how to structure your pgflow codebase for maintainability and reusability
sidebar:
  order: 20
---

import { Aside, Steps, CardGrid, LinkCard } from "@astrojs/starlight/components";
import { FileTree } from '@astrojs/starlight/components';

This guide outlines best practices for organizing your pgflow codebase to improve maintainability, reusability, and clarity.

:::note[Flexible Structure]
The directory structure shown here is a **recommendation**, not a requirement. pgflow works with any file organization - what matters is that your flows are imported into the Control Plane (for compilation) and into your worker Edge Functions (for execution). Feel free to adapt the structure to your project's needs.
:::

## Recommended structure

After running `pgflow install`, you'll have a `flows/` directory set up. As your project grows, you can add a `tasks/` directory for reusable task functions:

```bash frame="none"
mkdir -p supabase/tasks
```

<FileTree>
- supabase
  - flows
    - analyze-website.ts (flow definition)
    - index.ts (re-exports all flows)
  - tasks
    - scrapeWebsite.ts
    - summarizeWithAI.ts
    - extractTags.ts
    - saveWebsite.ts
    - index.ts (optional - re-exports tasks)
  - functions
    - pgflow
      - index.ts (Control Plane)
      - deno.json
    - analyze-website-worker
      - index.ts (worker for this flow)
      - deno.json
  - migrations
</FileTree>

This structure enables:

- **First-class concepts**: Flows and tasks are not hidden in underscore-prefixed folders
- **Self-documenting**: Structure clearly shows where things go
- **Clean imports**: `../../flows/index.ts` from Control Plane, `../tasks/` from flows
- **Scalable**: Ready for multiple flows and workers
- **Barrel exports**: Each directory has an `index.ts` for clean re-exports

## The index.ts pattern

Each directory uses an `index.ts` barrel file that re-exports all modules:

```typescript title="supabase/flows/index.ts"
// Re-export all flows from this directory
export { AnalyzeWebsite } from './analyze-website.ts';
export { ProcessOrder } from './process-order.ts';
```

```typescript title="supabase/tasks/index.ts" (optional)
// Re-export all tasks from this directory
export { scrapeWebsite } from './scrapeWebsite.ts';
export { summarizeWithAI } from './summarizeWithAI.ts';
```

This pattern provides:

- Clean imports from other files
- Single place to see all available flows/tasks
- Better IDE support with autocomplete
- Easy to add new flows - just add one export line

## Learn more

<CardGrid>
  <LinkCard
    title="Create Reusable Tasks"
    href="/build/create-reusable-tasks/"
    description="How to design task functions that work well across multiple flows"
  />
  <LinkCard
    title="Naming conventions"
    href="/concepts/naming-conventions/"
    description="Naming conventions for flows, steps, files, and workers"
  />
</CardGrid>

## Examples

<CardGrid>
  <LinkCard
    title="AI Web Scraper Tutorial"
    href="/tutorials/ai-web-scraper/"
    description="See the shared structure pattern in action with a complete real-world example"
  />
</CardGrid>
