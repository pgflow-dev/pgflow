new Flow<{ url: string; user_id: string }>({
  slug: 'analyze_website',
})
  .step(
    { slug: 'website' },
    async (flowInput) => await scrapeWebsite(flowInput.url)
  )
  .step(
    { slug: 'summary', dependsOn: ['website'] },
    async (deps) => await summarizeWithAI(deps.website.content)
  )
  .step(
    { slug: 'tags', dependsOn: ['website'] },
    async (deps) => await extractTags(deps.website.content)
  )
  .step(
    { slug: 'saveToDb', dependsOn: ['summary', 'tags'] },
    async (deps, ctx) =>
      await saveWebsite({
        user_id: ctx.flowInput.user_id,
        website_url: ctx.flowInput.url,
        summary: deps.summary,
        tags: deps.tags,
      })
  );
