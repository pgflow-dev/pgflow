---
title: Create your first worker
next:
    label: Configuration
    link: /edge-worker/configuration
---

import { Aside, Steps } from "@astrojs/starlight/components";
import { FileTree } from '@astrojs/starlight/components';
import NotProductionReady from '../../../components/NotProductionReady.astro';

Setting up your first worker is straightforward and takes just a few minutes.

<NotProductionReady />

<Aside type="caution" title="Requirements">
Before starting, please read the [Install Edge Worker](/edge-worker/install-edge-worker) guide.
</Aside>

<Steps>


1. ### Create your worker

    First, create a new Edge Function using the Supabase CLI. Then, replace its content with this code:

    ```typescript
    import { EdgeWorker } from "jsr:@pgflow/edge-worker";

    EdgeWorker.start(async (payload: { urlToScrape: string }) => {
      // do something with the message
      console.log('Scraping URL...', payload.urlToScrape);
    });
    ```

1. ### Start Edge Runtime

    Start the Edge Runtime by running the following command:

    ```bash frame="none"
		npx supabase functions serve
    ```

		:::note[Restarting Edge Runtime]
		You must stop and start the Edge Runtime everytime you make changes 
		to your workers, because of `per_worker` policy.
		:::

1. ### Start your worker

    Start the worker by sending an HTTP request to your Edge Function:

    ```bash frame="none"
    curl http://localhost:54321/functions/v1/<function-name>
    ```

4. ### Process your first message

    Your worker is now running and listening to the `tasks` queue (which was automatically created during startup).

    Send a test message:

    ```sql frame="none"
    SELECT pgmq.send(
      queue_name => 'tasks',
      msg => '{"urlToScrape": "https://example.com"}'::jsonb
    );
    ```

    The message will be processed immediately.

    <Aside title="Queue Name">
      By default, your worker uses a queue named `tasks`. You can change this by setting the [`queueName` option](/edge-worker/configuration#queuename) - useful when running multiple workers or integrating with existing queues.
    </Aside>

</Steps>
