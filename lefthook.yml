pre-commit:
  parallel: true
  commands:
    # checks
    frontend-check:
      glob: "frontend/**"
      run: |
        turbo run check --scope=frontend
    backend-check:
      glob: "supabase/**"
      run: |
        turbo run check --scope=backend
    ai-tools-check:
      glob: "ai-tools/**"
      run: |
        turbo run check --scope=ai-tools

    # lints
    frontend-format-staged:
      enabled: false
      glob: "frontend/**"
      root: frontend/
      run: pnpm format-staged && git add $(git diff --name-only --cached --relative=frontend/)
    frontend-lint:
      glob: "frontend/**"
      run: |
        turbo run lint --scope=frontend

    # autogenerating required artifacts
    supabase-types:
      glob: "supabase/migrations/*.sql"
      root: "supabase/"
      run: |
        node_modules/.bin/supabase gen types typescript --local && git add supabase/types.d.ts
    poetry-requirements:
      glob: "ai-tools/{pyproject.toml,poetry.lock}"
      root: ai-tools/
      run: |
        poetry export --without-hashes > requirements.txt && git add requirements.txt
